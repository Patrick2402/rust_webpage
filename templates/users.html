{% extends "base.html" %}
{% block head %}
{% endblock %}
{% block content %}
<p>are users useful to have in a non profit organization</p>
<table>
    <tr>
        <th>id</th>
        <th>username</th>
        <th>role</th>
        <th>delete</th>
    </tr>
{% for user in users %}
    <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.role }}</td>
        <td><button class="remove_user" data-username="{{ user.username }}">delete</button></td>
    <?tr>
{% endfor %}
</table>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    $('.remove_user').click(function() {
        const username = $(this).data('username');
        fetch('/api/delete_user?username=' + username, {
            method: "DELETE",
        }).then(response => { if (!response.ok) { throw new Error('Network fetch gone bad'); }
        }).catch(error => { console.log(error); })
    })
</script>
{% call super() %}
{% endblock %}
